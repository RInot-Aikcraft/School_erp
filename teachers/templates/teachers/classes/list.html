{% extends 'base.html' %}
{% load static %}

{% block title %}Mes Classes{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Mes Classes</h1>
        <div class="btn-toolbar mb-2 mb-md-0">
            <div class="btn-group me-2">
                <!-- Boutons pour les actions -->
            </div>
        </div>
    </div>

    <!-- Filtre par année scolaire -->
    <div class="row mb-4">
        <div class="col-md-12">
            <form method="get" class="form-inline">
                <div class="form-group mr-2">
                    <label for="school_year" class="mr-2">Année scolaire:</label>
                    <select name="school_year" id="school_year" class="form-control" onchange="this.form.submit()">
                        {% for year in school_years %}
                            <option value="{{ year.id }}" {% if year.id == selected_year.id %}selected{% endif %}>
                                {{ year.name }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
            </form>
        </div>
    </div>

    <!-- Liste des classes -->
    <div class="row">
        {% for class_id, class_data in classes_data.items %}
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h5 class="card-title mb-0">{{ class_data.class_obj.name }}</h5>
                    </div>
                    <div class="card-body">
                        <p class="card-text">
                            <strong>Niveau:</strong> {{ class_data.class_obj.level.name }}<br>
                            <strong>Année scolaire:</strong> {{ class_data.class_obj.school_year.name }}<br>
                            <strong>Nombre de matières:</strong> {{ class_data.subjects|length }}
                        </p>
                        <h6 class="mt-3">Matières enseignées:</h6>
                        <ul class="list-group list-group-flush">
                            {% for subject in class_data.subjects %}
                                <li class="list-group-item px-0">{{ subject.subject.name }}</li>
                            {% empty %}
                                <li class="list-group-item px-0">Aucune matière assignée</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="card-footer bg-white">
                        <a href="{% url 'teachers:class_detail' pk=class_data.class_obj.pk %}" class="btn btn-primary btn-block">Voir les détails</a>
                    </div>
                </div>
            </div>
        {% empty %}
            <div class="col-12">
                <div class="alert alert-info">
                    Vous n'avez aucune classe assignée pour cette année scolaire.
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}