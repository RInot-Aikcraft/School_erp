{% extends 'finance/base.html' %}
{% block finance_content %}
<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Enregistrer un paiement</h5>
    </div>
    <div class="card-body">
        <div class="alert alert-info">
            <strong>Élève:</strong> {{ fee.student.get_full_name }}<br>
            <strong>Type de frais:</strong> {{ fee.fee_structure.fee_type.name }}<br>
            <strong>Montant dû:</strong> {{ fee.amount_due }}<br>
            <strong>Déjà payé:</strong> {{ fee.amount_paid }}<br>
            <strong>Solde restant:</strong> {{ fee.balance }}
        </div>
        
        <form method="post">
            {% csrf_token %}
            <div class="form-group">
                <label for="{{ form.amount.id_for_label }}">Montant à payer</label>
                {{ form.amount }}
                {% if form.amount.errors %}
                    <div class="text-danger">{{ form.amount.errors }}</div>
                {% endif %}
                <small class="form-text text-muted">Le montant ne peut pas dépasser le solde restant ({{ fee.balance }})</small>
            </div>
            <div class="form-group">
                <label for="{{ form.payment_method.id_for_label }}">Méthode de paiement</label>
                {{ form.payment_method }}
                {% if form.payment_method.errors %}
                    <div class="text-danger">{{ form.payment_method.errors }}</div>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="{{ form.reference.id_for_label }}">Référence</label>
                {{ form.reference }}
                {% if form.reference.errors %}
                    <div class="text-danger">{{ form.reference.errors }}</div>
                {% endif %}
            </div>
            <div class="form-group">
                <label for="{{ form.notes.id_for_label }}">Notes</label>
                {{ form.notes }}
                {% if form.notes.errors %}
                    <div class="text-danger">{{ form.notes.errors }}</div>
                {% endif %}
            </div>
            <button type="submit" class="btn btn-primary">Enregistrer le paiement</button>
            <a href="{% url 'finance:student_fee_list' student_id=fee.student.id %}" class="btn btn-secondary">Annuler</a>
        </form>
    </div>
</div>
{% endblock %}